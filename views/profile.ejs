<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>

    <% if(success.length>0){%>
        <div id="flashMessage" class="absolute top-5 left-1/2 -translate-x-1/2 -translate-y-1/2 p-3 rounded-md bg-red-500 ">
          <span class="inline-block mt-1 mb-1 text-white">
              <%= success %>
          </span>
      </div>
      <%} %>
    
      <% if(error.length>0){%>
        <div id="flashMessageError" class="absolute top-5 left-1/2 -translate-x-1/2 -translate-y-1/2 p-3 rounded-md bg-red-500 ">
          <span class="inline-block mt-1 mb-1 text-white">
              <%= error %>
          </span>
      </div>
      <%} %>

    <%- include('./partials/headers.ejs') %>
    <!-- component -->
<div class="font-sans antialiased bg-gray-50 dark:bg-gray-900">
	<div class="container w-full md:max-w-3xl mx-auto">
		<div class="p-4 md:pt-32">
			<div class="md:shadow-xl md:rounded-lg">

				<div class="bg-gray-50 md:bg-white md:shadow-lg dark:bg-gray-900 md:dark:bg-gray-800 px-8">

					<div class="relative hidden md:block">
						<div class="block md:hidden flex justify-center">
							<img class="overflow-hidden w-32 h-32 rounded mr-4" src="https://ahampriyanshu.com/blog/logo.png" alt="author's image"></div>
                            
							<div class="pt-8 pb-2">
                                <div class=" flex justify-between">
                                    <% if(user.image){ %>
                                         <img class="overflow-hidden object-cover w-10 h-10 md:w-12 md:h-12 rounded " src="data:image/jpeg;base64,<%= user.image.toString('base64') %>" alt="author image" alt="author image">
                                   <% }else{ %>
                                    <img class="overflow-hidden object-cover w-10 h-10 md:w-12 md:h-12 rounded " src="data:image/png;base64,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" alt="author image" alt="author image">
                                  <% }%>

                                <button onclick="window.location.href='/users/profile/update'" class="text-blue-300">edit Profile</button>
                                </div>
								<h1 class="text-2xl font-bold text-gray-900 dark:text-white"><%= user.username %></h1>
								<p class="text-sm mt-2 text-gray-600 dark:text-gray-400">Contribututing since
								<%= user.date.getDate()%>-<%=user.date.getMonth()+1%>-<%=user.date.getFullYear()%>	</p>
								<div class="text-gray-600 dark:text-gray-400 text-xs md:text-sm">
									<p class="mt-2">
										<p> <%= user.about %> </p>
									</p>
								</div>

                                <a href="/posts/create" class="text-blue-600">create post</a>
								
							</div>
						</div>
					</div>
				</div>



                <p
					class="mb-5 font-bold text-xl md:text-5xl md:mt-6 text-center text-gray-900 dark:text-white">
					Posts from
					<%= user.username%></p>

                    <% user.posts.forEach((post)=>{ %>
                        <div class="mx-auto px-4 py-4 max-w-xl my-auto">
                            <div class="bg-gray-50 md:bg-white md:shadow-xl md:rounded-lg mb-6">
                                <a href='#'>
                                    <div class="">
        
        
                                    </div>
                                </a>
                                <div class="bg-gray-50 md:bg-white md:shadow-lg dark:bg-gray-900 md:dark:bg-gray-800">
                                    <a href='#'>
                                        <div class="p-4">
                                           <div class="flex justify-between">
                                            <p
                                            class="truncate font-bold mb-2 md:mt-2 text-2xl text-gray-600 dark:text-gray-200 tracking-normal">
                                            <%=post.title %></p>
                                            <button class="text-red-600" onclick="confirmDelete('<%= post._id %>')">delete</btton>
                                            <!-- <a href="/posts/deletepost/<%=post._id %>" class="text-red-600">delete</a> -->
                                            <a href="/posts/edit/<%=post._id %>" class="text-green-400">edit</a>

                                           </div>
                                           
                                                
                                            <div class="break-words text-sm text-gray-600 dark:text-gray-400 ">
                                                <p>
                                                    <p>&nbsp;</p>
        
                                                    <p> <%= post.content %> </p>
                                                </p>
                                                
                                            </div>
                                            
                                        </div>
                                    </a>
                                    <div class="flex items-center justify-between p-2 md:p-4 mx-2 md:mx-4">
                                        <a href='#'>
                                            <div class="flex items-center ml-2">
                                                <div class="text-xs ml-2 text-left text-gray-600 dark:text-gray-400">
                                                    <p>@<%=user.username%> </p>
                                                    <%= post.date.getDate()%>-<%=post.date.getMonth()+1%>-<%=post.date.getFullYear()%>
                                                </div>
                                            </div>
                                        </a>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    <%}) %>


			</div>
		</div>

        <script>
            // Function to hide flash messages with fade-out effect
            function hideFlashMessage(elementId) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.style.transition = 'opacity 0.5s ease'; // Set transition effect
                    element.style.opacity = '0'; // Start fading out
                    setTimeout(() => {
                        element.style.display = 'none'; // Remove from view after fade
                    }, 500); // Delay matches the transition duration
                }
            }
      
            // Trigger the hide function after 4 seconds for both messages
            setTimeout(() => hideFlashMessage('flashMessage'), 2000);
            setTimeout(() => hideFlashMessage('flashMessageError'), 2000);

        function confirmDelete(postId) {
            if (confirm('Are you sure you want to delete this post?')) {
            window.location.href = `/posts/deletepost/${postId}`;
        }
    }


        </script>
</body>
</html>